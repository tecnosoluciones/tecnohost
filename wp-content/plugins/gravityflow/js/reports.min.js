!function(o,s){"use strict";var e,a;function i(t){var o=[],t=(o.push('<option value="">{0}</option>'.format("All Steps")),a[t]);return s.each(t,function(t,r){o.push('<option value="{0}">{1}</option>'.format(r.id,r.name))}),o.join("")}function l(t){var r=[];r.push('<option value="">{0}</option>'.format("All Assignees"));for(var o=0;o<t.length;o++)r.push('<option value="{0}">{1}</option>'.format(t[o].key,t[o].name));return r.join("")}s(document).ready(function(){s(".gravityflow-reports-filter").each(function(){e=s(this).data("filter"),a=e.config;var t,r=e.selected,o=r.formId;s(this).find(".gravityflow-reports-category").toggle(!!o),o&&"step"==r.category&&(s(this).find(".gravityflow-reports-steps").html(i(o)),t=r.stepId,s(this).find(".gravityflow-reports-steps").val(t),s(this).find(".gravityflow-reports-steps").show(),t)&&(o=a[o][t].assignees,s(this).find(".gravityflow-reports-assignees").html(l(o)),s(this).find(".gravityflow-reports-assignees").val(r.assignee),s(this).find(".gravityflow-reports-assignees").show())}),s(".gravityflow-reports-filter form").on("submit",function(t){var r;s("body").hasClass("wp-admin")||(t.preventDefault(),r=s(this).parents(".gravityflow_workflow_reports"),s.ajax({url:gravityflow_status_list_strings.ajaxurl,method:"POST",data:{action:"gravityflow_render_reports",nonce:s(this).find(".gravityflow-reports-nonce").val(),args:s(this).find(".gravityflow-reports-args").val(),data:s(this).serialize()},success:function(t){"error"===t.status?alert(t.message):(r.find("#gravityflow-reports").html(t),o.drawCharts())}}))}),s(".gravityflow-form-drop-down").change(function(){s(this).nextAll(".gravityflow-reports-category").toggle(!!this.value),this.value&&s(this).nextAll(".gravityflow-reports-category").val("month"),s(this).nextAll(".gravityflow-reports-steps").hide(),s("#gravityflow-reports-assignees").hide()}),s(".gravityflow-reports-category").change(function(){var t=s(this).prev(".gravityflow-form-drop-down").val();"step"==this.value?(s(this).nextAll(".gravityflow-reports-steps").html(i(t)),s(this).nextAll(".gravityflow-reports-steps").show()):(s("#gravityflow-reports-assignees").hide(),s(this).nextAll(".gravityflow-reports-steps").hide())}),s(".gravityflow-reports-steps").change(function(){var t;this.value?(t=s(this).prevAll(".gravityflow-form-drop-down").val(),t=a[t][this.value].assignees,s(this).nextAll(".gravityflow-reports-assignees").html(l(t)),s(this).nextAll(".gravityflow-reports-assignees").show()):s(this).nextAll(".gravityflow-reports-assignees").hide()})}),o.drawCharts=function(){s(".gravityflow_chart").each(function(){var t,r=s(this),o=r.data("table");void 0!==o&&(o=google.visualization.arrayToDataTable(o),t=r.data("options"),r=r.data("type"),new google.charts[r](this).draw(o,t))})},String.prototype.format=function(){var o=arguments;return this.replace(/{(\d+)}/g,function(t,r){return void 0!==o[r]?o[r]:t})}}(window.Gravity_Flow_Reports=window.Gravity_Flow_Reports||{},jQuery),google.load("visualization","1.1",{packages:["bar"]}),google.setOnLoadCallback(Gravity_Flow_Reports.drawCharts);