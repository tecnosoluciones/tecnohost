!function(f){f(document).ready(function(){f(".gravityflow-actions-unlock").click(function(){var i=f(this),o=i.siblings(".gravityflow-actions-lock"),a=i.siblings(".gravityflow-actions-note-field-container"),s=i.siblings(".gravityflow-actions");i.hide(),o.show(),a.hide(),s.hide(),i.parent(".gravityflow-actions").addClass("gravityflow-actions-locked")}),f(".gravityflow-action").click(function(){var i,o,a,s,t=f(this),n=t.siblings(".gravityflow-actions-unlock"),e=t.siblings(".gravityflow-actions-lock"),l=t.siblings(".gravityflow-actions-note-field-container"),c=l.find("textarea"),r=t.data("note_field");t.hasClass("gravityflow-action-processed")||(t.parent(".gravityflow-actions").hasClass("gravityflow-actions-locked")?(t.parent(".gravityflow-actions").removeClass("gravityflow-actions-locked"),e.hide(),n.show(),r?(l.show(),c.focus(),f(document).keyup(function(i){27==i.keyCode&&n.click()})):setTimeout(function(){t.hasClass("gravityflow-action-processing")||t.hasClass("gravityflow-action-processed")||(t.parent(".gravityflow-actions").addClass("gravityflow-actions-locked"),e.show(),n.hide())},2e3)):(r=parseInt(t.data("entry_id")),l=t.data("rest_base"),i=t.data("action"),o=gravityflow_inbox_strings.restUrl,a=gravityflow_inbox_strings.nonce,s=t.siblings(".gravityflow-actions-spinner"),f.ajax({method:"POST",url:o+"gf/v2/entries/"+r+"/workflow/"+l,data:{action:i,gravityflow_note:c.val()},beforeSend:function(i){i.setRequestHeader("X-WP-Nonce",a),t.siblings().andSelf().hide(),t.addClass("gravityflow-action-processing"),s.show()},success:function(i){s.hide(),t.removeClass("gravityflow-action-processing"),"success"==i.status?(t.addClass("gravityflow-action-processed"),t.prop("title",i.feedback),t.show(),t.parent(".gravityflow-actions").removeClass("gravityflow-actions-locked")):(t.parent(".gravityflow-actions").addClass("gravityflow-actions-locked"),t.siblings(".gravityflow-action").andSelf().show(),e.show(),alert(i.feedback))},fail:function(i){s.hide(),n.hide(),e.show(),t.removeClass("gravityflow-action-processing"),t.siblings(".gravityflow-actions").andSelf().show(),alert(i)}})))})})}((window.GravityFlowInbox=window.GravityFlowInbox||{},jQuery));